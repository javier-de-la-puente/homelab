* Provision the server with PXE


** Configure openwrt




#+begin_src sh
wget -c https://releases.ubuntu.com/26.04-snapshot1/ubuntu-26.04-netboot-amd64.tar.gz
tar xfz ubuntu-26.04-netboot-amd64.tar.gz
#+end_src

Update grub.cfg, the image is wrong, use https://releases.ubuntu.com/26.04-snapshot1/ubuntu-26.04-live-server-amd64.iso.
Also set autoboot after 5 secs.
It should be comething like:
#+name ./amd64/grub/grub.cfg
#+begin_src
set default=0
set timeout=5
menuentry "Install Ubuntu Server" {
        set gfxpayload=keep
        linux   linux iso-url=https://releases.ubuntu.com/26.04-snapshot1/ubuntu-26.04-live-server-amd64.iso ip=dhcp autoinstall "ds=nocloud-net;s=http://192.168.0.1:8080/" ---
        initrd  initrd
}
#+end_src


#+begin_src
scp -r amd64/ root@192.168.0.1:/mnt/extstorage/tftp
#+end_src


#+name /etc/config/dhcp
#+begin_src
config dnsmasq
  ...
  option enable_tftp '1'
  option tftp_root '/mnt/extstorage/tftp'
  option dhcp_boot 'bootx64.efi'
#+end_src
/etc/init.d/dnsmasq restart


#+name /etc/config/uhttpd
#+begin_src
...
config uhttpd 'extra'
	list listen_http '0.0.0.0:8080'
	option home '/mnt/extstorage/uhttp'
#+end_src
/etc/init.d/uhttpd restart


When booting, you can do in openwrt:

#+begin_src
logread -f
#+end_src



Now meta-data and user-data
#+begin_src
scp meta-data user-data root@192.168.0.1:/mnt/extstorage/uhttpd
#+end_src

Ok, now boot from PXE... it may work :)


* ??
